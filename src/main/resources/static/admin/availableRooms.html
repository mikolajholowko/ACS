<!DOCTYPE html>
<html lang="pl">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>QR</title>
    <link rel="stylesheet" href="admin/style.css">

</head>
<body>
<div class="containter">
    <div class="navbar">
        <img src="admin/logo.png" alt="logo" class="logo">
        <nav>
            <ul id="menuList">
                <li><a href="/admin">QR Code</a></li>
                <li><a href="/admin-create-account">Utw√≥rz konto</a></li>
                <li><a href="/admin-account-update">Ustawienia konta</a></li>
                <li><a href="/">Wyloguj</a></li>
            </ul>
        </nav>
        <img src="admin/menu.png" alt="menu" class="menuic"
             onclick="togglemenu()">
    </div>
    <div class="rowtable">
        <div class="table-container">
            <div class="table-container">
                <table class="table" id="rooms-table">
                    <thead>
                    <tr>
                        <th>Nazwa pomieszczenia</th>
                        <th>Numer pokoju</th>
                        <th>STATUS</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div>
<script>

    var menuList = document.getElementById("menuList");
    menuList.style.maxHeight = "0px";
    function togglemenu(){
        if(menuList.style.maxHeight == "0px")
        {
            menuList.style.maxHeight = "135px";
        }
        else
        {
            menuList.style.maxHeight = "0px";
        }
    }

    let getEmployeeList = async () => {
        return fetch('auth/employee', {
            method: "GET",
            headers: {'Content-Type': 'application/json'}
        }).then(response => response.json())
        .then(response2 => {
           return response2.id;
        })
    }

    let getRooms = async () => {
        const id = await getEmployeeList();
        const url = "/rooms/access/" + id;
        console.log(url);
        return fetch(url, {
            method: "GET",
            headers: {'Content-Type': 'application/json'}
        }).then(response => response.json())
    }

    let fillTable = async () => {
        const data = await getRooms();
        console.log(data);
        let tbodyRef = document.getElementById('rooms-table').getElementsByTagName('tbody')[0]

        for (let i = 0; i < data.length; i++){
            //insert Row
            tbodyRef.insertRow().innerHTML =
                "<td>" + data[i].roomName+ "</td>"+
                "<td>" +data[i].roomNumber+ "</td>"+
                "<td>" +data[i].active+ "</td>";
        }
    }

    fillTable();

</script>
</body>
</html>